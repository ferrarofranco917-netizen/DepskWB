<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>üí∞ BudgetWise 2.0 - Gestione Finanziaria Intelligente</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#16181b">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="BudgetWise">
    <meta name="description" content="Gestisci le tue finanze da stipendio a stipendio con l'assistente AI">
    <meta name="format-detection" content="telephone=no">
    
    <!-- Geist / Dark Premium (Inter fallback per numeri) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- SheetJS per leggere file Excel -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.2/package/dist/xlsx.full.min.js"></script>
    
    <!-- Meta tags social -->
    <meta property="og:title" content="BudgetWise 2.0">
    <meta property="og:description" content="Gestione finanziaria intelligente con assistente AI">
    <meta property="og:image" content="icon-512.png">
    <meta property="og:url" content="https://budgetwise.app">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="BudgetWise 2.0">
    <meta name="twitter:description" content="Gestisci le tue finanze con intelligenza artificiale">
    <meta name="twitter:image" content="icon-512.png">
    
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="icon-192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icon-192.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icon-192.png">
    <link rel="mask-icon" href="icon-512.png" color="#38bdf8">
    
    <!-- Forza aggiornamento cache -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
</head>
<body>
    <!-- ... TUTTO IL CONTENUTO DEL BODY RIMANE IDENTICO ... -->
    <!-- (ho omesso per brevit√†, ma deve rimanere tutto uguale) -->
    
    <!-- LICENSE SYSTEM - CARICATO PRIMA -->
    <script src="license-system.js"></script>
    
    <!-- APP.JS - CARICATO DOPO -->
    <script src="app.js"></script>
    
    <!-- Service Worker e check icone (spostato dopo gli script principali) -->
    <script>
      window.addEventListener("load", async () => {
        // check icone
        fetch("./icon-192.png")
          .then(() => console.log("‚úÖ Icona 192px OK"))
          .catch(() => console.warn("‚ö†Ô∏è Icona 192px non trovata"));
        fetch("./icon-512.png")
          .then(() => console.log("‚úÖ Icona 512px OK"))
          .catch(() => console.warn("‚ö†Ô∏è Icona 512px non trovata"));

        // Service Worker
        if (!("serviceWorker" in navigator)) return;
        try {
          const reg = await navigator.serviceWorker.register("./sw.js?v=20260226v17", { scope: "./" });
          console.log("‚úÖ ServiceWorker registrato:", reg.scope);

          await reg.update().catch(() => {});

          if (reg.waiting) {
            reg.waiting.postMessage({ type: "SKIP_WAITING" });
          }

          navigator.serviceWorker.addEventListener("controllerchange", () => {
            if (sessionStorage.getItem("bw_sw_reloaded") === "1") return;
            sessionStorage.setItem("bw_sw_reloaded", "1");
            setTimeout(() => window.location.reload(), 50);
          });
        } catch (err) {
          console.log("‚ùå ServiceWorker errore:", err);
        }
      });
    </script>
    
    <!-- ... TUTTI I MODAL RIMANGONO IDENTICI ... -->
    
</body>
</html>
